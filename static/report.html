<head>
    <script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
    <script src="/static/report.js"></script>
</head>
<html>
    <input type="text" id="name-input"/>
    <div id="irating-history-per-date" style="width:800px;height:450px;"></div>
    <div id="irating-history-per-race" style="width:800px;height:450px;"></div>
    <div id="car-track-time-stats"/>
    <div id="car-track-laps-stats"/>
    <div id="car-track-time-stack-stats"/>
    <script>
        nameInput = document.getElementById("name-input");
        iratingHistoryDateDiv = document.getElementById('irating-history-per-date');
        iratingHistoryRaceDiv = document.getElementById('irating-history-per-race');
        carTrackTimeStatsDiv = document.getElementById('car-track-time-stats');
        carTrackLapsStatsDiv = document.getElementById('car-track-laps-stats');
        carTrackTimeStackStatsDiv = document.getElementById('car-track-time-stack-stats');

        let paramString = window.location.search.split('?')[1];
        let queryString = new URLSearchParams(paramString);

        let urlDriver = queryString.get('driver');
        if (urlDriver) {
            nameInput.value = urlDriver;
            updateDriver(urlDriver);
        }

        function updateDriver(name) {
            if (!name) {
                console.log("Empty name");
                return;
            }

            updateIratingHistory(iratingHistoryDateDiv, iratingHistoryRaceDiv, name);
            updateCarTrackUsageStats(carTrackTimeStatsDiv, carTrackLapsStatsDiv, carTrackTimeStackStatsDiv, name);
        }

        nameInput.onkeypress = function(ev) {
            if (ev.keyCode == 13) { // enter
                updateDriver(nameInput.value);
            }
        }
    </script>
</html>
